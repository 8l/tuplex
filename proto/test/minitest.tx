module my

func puts(str : &[]UByte) {
    tx.c.puts(str^[0])
}

type AType mod derives Tuple {
    f : ~Int
    public func print() Int {
        puts(c"AType")
        return self^.f
    }
}

type BType mod derives AType {
    g : ~Int
    public func print() Int {
        puts(c"BType")
        return self^.g
    }
}

func main() Int {
    a : AType
    b : BType
    a.f = 1
    b.g = 2
    ar : &AType = &b
    br : &BType = &b

    r : ~Int
    r = r + ar^.print()
    r = r + br^.print()

    return r
}
